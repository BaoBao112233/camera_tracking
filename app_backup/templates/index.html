<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Tracking - Đếm Người</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin:0; padding:20px; background:#f5f5f5; }
        .container { max-width: 900px; margin:0 auto; background:white; border-radius:10px;
                     box-shadow:0 4px 6px rgba(0,0,0,0.1); overflow:hidden; }
        .header { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:20px; text-align:center; }
        .header h1 { margin:0; font-size:2em; }
        .video-container { text-align:center; margin:20px; }
        .video-stream { max-width:100%; border:3px solid #667eea; border-radius:10px; }
        .stat-card { margin:20px auto; text-align:center; background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);
                     padding:20px; border-radius:10px; box-shadow:0 4px 6px rgba(0,0,0,0.1); width:200px; }
        .stat-number { font-size:3em; font-weight:bold; margin:10px 0; }
        .stat-label { font-size:1.2em; opacity:0.9; }
        .btn { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; border:none; padding:10px 20px;
               border-radius:25px; font-size:1em; cursor:pointer; margin-top:10px; }
        .btn:hover { opacity:0.9; }
        .status { text-align:center; margin-top:15px; font-weight:bold; }
        .status.online { color:green; }
        .status.offline { color:red; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎥 Camera Tracking</h1>
            <p>Hệ thống đếm người hiện tại</p>
        </div>

        <div class="video-container">
            <img id="videoStream" class="video-stream" src="/video_feed" alt="Video Stream">
        </div>

        <div class="stat-card">
            <div class="stat-number" id="peopleCount">0</div>
            <div class="stat-label">👥 Người Hiện Tại</div>
        </div>

        <div style="text-align:center;">
            <button class="btn" onclick="refreshStats()">🔄 Cập Nhật</button>
            <button class="btn" style="background:linear-gradient(135deg,#fa709a 0%,#fee140 100%);" onclick="resetCount()">🗑️ Reset</button>
        </div>

        <div id="status" class="status online">🟢 Hệ thống đang hoạt động</div>
    </div>

    <script>
        function refreshStats() {
            fetch('/stats')
                .then(r => r.json())
                .then(data => {
                    document.getElementById('peopleCount').textContent = data.people_count;
                    document.getElementById('status').className = 'status online';
                    document.getElementById('status').textContent = '🟢 Hệ thống đang hoạt động';
                })
                .catch(err => {
                    console.error(err);
                    document.getElementById('status').className = 'status offline';
                    document.getElementById('status').textContent = '🔴 Lỗi kết nối';
                });
        }

        function resetCount() {
            fetch('/reset_count', { method: 'POST' })
                .then(r => r.json())
                .then(data => { alert(data.message); refreshStats(); });
        }

        // auto refresh mỗi giây
        setInterval(refreshStats, 1000);
        document.addEventListener('DOMContentLoaded', refreshStats);
    </script>
</body>
</html>
